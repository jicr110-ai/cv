<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CV Interactivo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Estilo para los campos editables */
        [contenteditable="true"] {
            outline: 2px dashed transparent;
            transition: outline 0.3s;
            padding: 4px;
            border-radius: 4px;
        }
        [contenteditable="true"]:hover,
        [contenteditable="true"]:focus {
            outline-color: #3b82f6; /* blue-500 */
            background-color: #eff6ff; /* blue-50 */
        }
        /* Ocultar elementos que no deben imprimirse en el PDF */
        .no-print {
            display: block;
        }
        /* Estilo para la foto de perfil editable */
        .editable-image {
            cursor: pointer;
            position: relative;
        }
        .editable-image:hover::after {
            content: 'Cambiar foto';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 8px;
            border-bottom-left-radius: 9999px;
            border-bottom-right-radius: 9999px;
            text-align: center;
            font-size: 0.875rem;
        }
    </style>
</head>
<body class="bg-slate-100 flex items-center justify-center min-h-screen p-4">

    <main id="cv-container" class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-auto overflow-hidden">
        <div class="p-8 md:p-12">
            <!-- Pantalla Inicial -->
            <section id="initial-screen">
                <div class="text-center">
                    <input type="file" id="photo-upload" class="hidden" accept="image/*">
                    <img id="profile-pic" src="https://placehold.co/150x150/e2e8f0/475569?text=Tu+Foto" alt="Foto de perfil" class="w-36 h-36 rounded-full mx-auto mb-4 border-4 border-white shadow-lg object-cover editable-image">
                    <h1 id="user-name" contenteditable="true" class="text-3xl font-bold text-slate-800">Tu Nombre Aquí</h1>
                    <p id="user-title" contenteditable="true" class="text-xl text-slate-500 mt-2">Tu Puesto o Profesión</p>
                </div>

                <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mt-10 no-print">
                    <button onclick="showSection('info-general')" class="nav-button bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg transition-transform transform hover:scale-105">Información General</button>
                    <button onclick="showSection('experiencia')" class="nav-button bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg transition-transform transform hover:scale-105">Experiencia Laboral</button>
                    <button onclick="showSection('trabajo-actual')" class="nav-button bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg transition-transform transform hover:scale-105">Trabajo Actual</button>
                    <button onclick="showSection('escolaridad')" class="nav-button bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg transition-transform transform hover:scale-105">Escolaridad</button>
                    <button onclick="showSection('cursos')" class="nav-button bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg transition-transform transform hover:scale-105">Cursos</button>
                    <button onclick="showSection('desempeno')" class="nav-button bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg transition-transform transform hover:scale-105">Desempeño y Logros</button>
                </div>
            </section>

            <!-- Contenedor para las secciones de información -->
            <div id="info-sections" class="mt-8">
                <!-- Sección de Información General -->
                <section id="info-general" class="info-section hidden">
                    <h2 class="section-title">Información General</h2>
                    <div class="section-content">
                        <p><strong>Email:</strong> <span contenteditable="true">tu.email@ejemplo.com</span></p>
                        <p><strong>Teléfono:</strong> <span contenteditable="true">+52 1 55 1234 5678</span></p>
                        <p><strong>Ubicación:</strong> <span contenteditable="true">Ciudad, País</span></p>
                        <p><strong>LinkedIn:</strong> <span contenteditable="true">linkedin.com/in/tu-perfil</span></p>
                        <h3 class="font-semibold text-slate-700 mt-4">Resumen Profesional</h3>
                        <p contenteditable="true" class="mt-1 text-slate-600">Un breve resumen sobre tu perfil profesional, tus habilidades clave y tus objetivos. Describe en qué te especializas y qué buscas en tu próxima oportunidad laboral.</p>
                    </div>
                    <button onclick="goBack()" class="back-button no-print">Volver</button>
                </section>

                <!-- Sección de Experiencia Laboral -->
                <section id="experiencia" class="info-section hidden">
                    <h2 class="section-title">Experiencia Laboral (Anterior)</h2>
                    <div class="section-content">
                        <div class="mb-6">
                            <h3 contenteditable="true" class="text-xl font-semibold text-slate-800">Nombre del Puesto Anterior</h3>
                            <p contenteditable="true" class="text-md text-slate-600">Nombre de la Empresa | Fechas (Ej: Ene 2020 - Dic 2022)</p>
                            <p contenteditable="true" class="mt-2 text-slate-600">Describe tus responsabilidades y logros en este puesto. Usa viñetas para que sea más fácil de leer. Menciona proyectos importantes en los que participaste.</p>
                        </div>
                        <div class="mb-6">
                            <h3 contenteditable="true" class="text-xl font-semibold text-slate-800">Otro Puesto Anterior</h3>
                            <p contenteditable="true" class="text-md text-slate-600">Otra Empresa | Fechas (Ej: Jun 2018 - Dic 2019)</p>
                            <p contenteditable="true" class="mt-2 text-slate-600">Continúa detallando tu experiencia previa aquí.</p>
                        </div>
                    </div>
                    <button onclick="goBack()" class="back-button no-print">Volver</button>
                </section>

                <!-- Sección de Trabajo Actual -->
                <section id="trabajo-actual" class="info-section hidden">
                    <h2 class="section-title">Trabajo Actual</h2>
                    <div class="section-content">
                        <h3 contenteditable="true" class="text-xl font-semibold text-slate-800">Tu Puesto Actual</h3>
                        <p contenteditable="true" class="text-md text-slate-600">Nombre de la Empresa Actual | Fechas (Ej: Ene 2023 - Presente)</p>
                        <p contenteditable="true" class="mt-2 text-slate-600">Describe tus responsabilidades actuales. Enfócate en tus contribuciones más recientes y en cómo agregas valor a tu equipo y a la empresa. Puedes mencionar tecnologías o metodologías que utilizas.</p>
                    </div>
                    <button onclick="goBack()" class="back-button no-print">Volver</button>
                </section>

                <!-- Sección de Escolaridad -->
                <section id="escolaridad" class="info-section hidden">
                    <h2 class="section-title">Escolaridad</h2>
                    <div class="section-content">
                        <div class="mb-4">
                            <h3 contenteditable="true" class="text-xl font-semibold text-slate-800">Nombre de tu Título o Grado</h3>
                            <p contenteditable="true" class="text-md text-slate-600">Nombre de la Universidad o Institución | Año de Graduación</p>
                        </div>
                         <div class="mb-4">
                            <h3 contenteditable="true" class="text-xl font-semibold text-slate-800">Otro Título o Grado</h3>
                            <p contenteditable="true" class="text-md text-slate-600">Nombre de la Institución | Año de Graduación</p>
                        </div>
                    </div>
                    <button onclick="goBack()" class="back-button no-print">Volver</button>
                </section>

                <!-- Sección de Cursos -->
                <section id="cursos" class="info-section hidden">
                    <h2 class="section-title">Cursos y Certificaciones</h2>
                    <div class="section-content">
                        <ul class="list-disc list-inside text-slate-600">
                            <li contenteditable="true">Nombre del Curso/Certificación - Institución (Año)</li>
                            <li contenteditable="true">Otro Curso Relevante - Plataforma (Año)</li>
                            <li contenteditable="true">Certificación en [Tecnología] - Entidad Certificadora (Año)</li>
                        </ul>
                    </div>
                    <button onclick="goBack()" class="back-button no-print">Volver</button>
                </section>

                <!-- Sección de Desempeño y Logros -->
                <section id="desempeno" class="info-section hidden">
                    <h2 class="section-title">Desempeño y Solución de Problemas</h2>
                    <div class="section-content">
                        <h3 class="font-semibold text-slate-700 mt-4">Ejemplo de Solución de Problema:</h3>
                        <p contenteditable="true" class="mt-1 text-slate-600">Describe una situación o desafío específico que enfrentaste en un trabajo anterior. Explica los pasos que tomaste para analizar y resolver el problema, y cuál fue el resultado positivo de tus acciones. (Ej: "Optimicé un proceso que redujo los tiempos de espera en un 20% mediante...").</p>
                        <h3 class="font-semibold text-slate-700 mt-4">Logro Destacado:</h3>
                        <p contenteditable="true" class="mt-1 text-slate-600">Menciona un logro del que te sientas particularmente orgulloso. Cuantifica el resultado si es posible. (Ej: "Lideré un equipo para lanzar un nuevo producto que generó un aumento del 15% en las ventas en el primer trimestre.").</p>
                    </div>
                    <button onclick="goBack()" class="back-button no-print">Volver</button>
                </section>
            </div>
        </div>

        <!-- Botón para generar PDF -->
        <div class="bg-slate-50 p-6 text-center no-print">
            <button id="generate-pdf" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-lg transition-transform transform hover:scale-105">
                Generar PDF
            </button>
        </div>
    </main>

    <script>
        // Importar jsPDF
        const { jsPDF } = window.jspdf;

        // --- Lógica para subir foto ---
        const profilePic = document.getElementById('profile-pic');
        const photoUpload = document.getElementById('photo-upload');

        profilePic.addEventListener('click', () => {
            photoUpload.click();
        });

        photoUpload.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    profilePic.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        });

        // Función para mostrar una sección específica y ocultar las demás
        function showSection(sectionId) {
            document.getElementById('initial-screen').classList.add('hidden');
            document.querySelectorAll('.info-section').forEach(section => {
                section.classList.add('hidden');
            });
            const activeSection = document.getElementById(sectionId);
            if (activeSection) {
                activeSection.classList.remove('hidden');
            }
        }

        // Función para volver a la pantalla inicial
        function goBack() {
            document.querySelectorAll('.info-section').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById('initial-screen').classList.remove('hidden');
        }
        
        // Estilos comunes para los elementos de las secciones
        const styleSheet = document.createElement("style");
        styleSheet.innerText = `
            .section-title { font-size: 1.75rem; font-weight: 700; color: #1e293b; border-bottom: 2px solid #e2e8f0; padding-bottom: 0.5rem; margin-bottom: 1.5rem; }
            .section-content { color: #475569; line-height: 1.6; }
            .back-button { margin-top: 2rem; background-color: #64748b; color: white; font-weight: 600; padding: 0.75rem 1.5rem; border-radius: 0.5rem; transition: background-color 0.3s; }
            .back-button:hover { background-color: #475569; }
        `;
        document.head.appendChild(styleSheet);
        
        // --- Lógica mejorada para generar el PDF ---
        document.getElementById('generate-pdf').addEventListener('click', () => {
            const cvContainer = document.getElementById('cv-container');
            const userName = document.getElementById('user-name').innerText;
            const fileName = `CV_${userName.replace(/ /g, '_')}.pdf`;

            // Ocultar botones y mostrar todas las secciones para la captura
            document.querySelectorAll('.no-print').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.info-section').forEach(section => section.classList.remove('hidden'));
            document.getElementById('initial-screen').classList.remove('hidden');

            html2canvas(cvContainer, {
                scale: 2,
                useCORS: true,
                onclone: (doc) => {
                    doc.querySelectorAll('[contenteditable="true"]').forEach(field => {
                        field.style.outline = 'none';
                        field.style.backgroundColor = 'transparent';
                    });
                }
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF('p', 'mm', 'a4');
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = pdf.internal.pageSize.getHeight();
                
                const canvasWidth = canvas.width;
                const canvasHeight = canvas.height;
                
                const ratio = canvasWidth / canvasHeight;
                const imgHeight = pdfWidth / ratio;
                let heightLeft = imgHeight;
                let position = 0;

                pdf.addImage(imgData, 'PNG', 0, position, pdfWidth, imgHeight);
                heightLeft -= pdfHeight;

                while (heightLeft > 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, pdfWidth, imgHeight);
                    heightLeft -= pdfHeight;
                }
                
                pdf.save(fileName);

                // Restaurar la vista original
                document.querySelectorAll('.no-print').forEach(el => el.style.display = '');
                goBack();
            });
        });
    </script>
</body>
</html>